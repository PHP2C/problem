<?php
$data = '
[
    {
        "id": 652,
        "answers": "3,2,1,3,3,1,3,2,3,1,3,3,3,2,2,2,2,1",
        "user_id": 259,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "罗永欢",
        "user_account": "1425",
        "age": 13,
        "create_time": "2023-06-07 09:07:33",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 645,
        "answers": "3,3,2,3,2,3,3,2,2,1,3,3,3,2,2,2,1,1",
        "user_id": 256,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "成懿鑫",
        "user_account": "90006534241",
        "age": 16,
        "create_time": "2023-06-02 15:19:03",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 639,
        "answers": "3,3,3,2,3,1,3,3,3,1,3,2,3,2,2,3,3,1",
        "user_id": 255,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "胡蕴涵",
        "user_account": "90004499045",
        "age": 16,
        "create_time": "2023-06-02 13:46:45",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 628,
        "answers": "1,1,2,3,2,2,2,1,2,2,2,3,2,2,2,1,3,2",
        "user_id": 253,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "刘小燕",
        "user_account": "900065357744",
        "age": 15,
        "create_time": "2023-06-02 09:43:00",
        "warning": 1,
        "inspect": 0
    },
    {
        "id": 622,
        "answers": "3,3,1,2,1,2,3,2,3,1,3,2,3,2,2,3,1,1",
        "user_id": 251,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "陈焱柔",
        "user_account": "90004660933",
        "age": 12,
        "create_time": "2023-05-31 16:54:34",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 616,
        "answers": "1,3,2,3,2,2,3,3,3,2,3,3,3,3,2,3,1,1",
        "user_id": 249,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "李欣芸",
        "user_account": "90005602357",
        "age": 12,
        "create_time": "2023-05-31 16:01:30",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 557,
        "answers": "1,2,1,3,1,2,3,2,3,3,3,3,3,2,3,2,1,1",
        "user_id": 230,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "丁裬倣",
        "user_account": "1410",
        "age": 11,
        "create_time": "2023-05-26 08:31:34",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 526,
        "answers": "2,3,2,1,2,3,2,3,2,2,3,3,3,2,3,2,2,1",
        "user_id": 220,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "李佳奇",
        "user_account": "90006521827",
        "age": 13,
        "create_time": "2023-05-19 14:45:59",
        "warning": 1,
        "inspect": 0
    },
    {
        "id": 520,
        "answers": "2,2,1,1,1,2,3,2,3,1,3,3,3,3,1,2,1,1",
        "user_id": 219,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "简丹",
        "user_account": "90006520008",
        "age": 14,
        "create_time": "2023-05-19 13:45:24",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 497,
        "answers": "2,1,1,3,2,2,3,3,3,1,3,3,3,2,2,3,1,2",
        "user_id": 213,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "田紫琰",
        "user_account": "90006519722",
        "age": 15,
        "create_time": "2023-05-17 11:56:44",
        "warning": 0,
        "inspect": 1
    },
    {
        "id": 441,
        "answers": "3,1,3,1,3,3,2,1,1,3,3,2,2,3,3,2,3,3",
        "user_id": 195,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "神经内科一病区",
        "user_name": "代雯婷",
        "user_account": "1386",
        "age": 14,
        "create_time": "2023-05-10 09:29:58",
        "warning": 1,
        "inspect": 0
    },
    {
        "id": 411,
        "answers": "3,2,1,3,2,2,2,2,3,1,3,2,3,2,1,2,1,1",
        "user_id": 184,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "陈雅楠",
        "user_account": "90005233754",
        "age": 15,
        "create_time": "2023-05-05 08:22:39",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 376,
        "answers": "2,2,1,2,2,1,2,2,2,1,2,3,3,2,1,3,2,1",
        "user_id": 174,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "刘梓涵",
        "user_account": "1372",
        "age": 15,
        "create_time": "2023-04-27 11:08:49",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 351,
        "answers": "3,1,1,3,3,3,3,3,3,1,3,3,3,3,1,3,2,2",
        "user_id": 164,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "郭仕漫",
        "user_account": "90006339271",
        "age": 16,
        "create_time": "2023-04-25 15:22:06",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 349,
        "answers": "3,3,1,3,1,1,3,3,3,1,3,3,3,1,1,3,1,1",
        "user_id": 163,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "任柯",
        "user_account": "1364",
        "age": 14,
        "create_time": "2023-04-25 15:10:17",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 347,
        "answers": "1,3,1,3,1,1,3,3,3,1,3,3,3,1,1,3,1,1",
        "user_id": 161,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "任柯",
        "user_account": "1362",
        "age": 14,
        "create_time": "2023-04-25 14:51:17",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 343,
        "answers": "2,2,1,1,2,2,2,2,2,1,3,2,3,2,1,1,1,1",
        "user_id": 159,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "杜思瑶",
        "user_account": "1360",
        "age": 15,
        "create_time": "2023-04-25 13:30:52",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 303,
        "answers": "2,2,2,3,3,2,3,1,2,1,3,3,3,3,1,2,2,1",
        "user_id": 141,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "神经内科二病区",
        "user_name": "弭子恒",
        "user_account": "1348",
        "age": 15,
        "create_time": "2023-04-19 11:30:16",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 230,
        "answers": "2,2,2,2,2,2,2,2,2,1,3,2,3,3,3,2,2,2",
        "user_id": 102,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": null,
        "department_name": "精神（心理）门诊",
        "user_name": "唐志涵",
        "user_account": "1320",
        "age": 12,
        "create_time": "2023-04-11 13:54:43",
        "warning": 1,
        "inspect": 0
    },
    {
        "id": 189,
        "answers": "1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1",
        "user_id": 90,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "即可i",
        "user_account": "1311",
        "age": 45,
        "create_time": "2023-04-06 14:53:02",
        "warning": 1,
        "inspect": 0
    },
    {
        "id": 177,
        "answers": "3,3,1,3,2,2,3,3,3,1,3,3,3,2,2,3,1,1",
        "user_id": 87,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "陈彦希",
        "user_account": "1308",
        "age": 11,
        "create_time": "2023-04-06 13:51:05",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 175,
        "answers": "2,1,1,3,2,2,1,3,3,1,2,3,3,2,2,2,1,1",
        "user_id": 86,
        "sex": 0,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "陈彦希",
        "user_account": "1307",
        "age": 11,
        "create_time": "2023-04-06 13:34:44",
        "warning": 0,
        "inspect": 0
    },
    {
        "id": 168,
        "answers": "3,3,1,1,3,3,3,2,3,1,3,3,3,1,3,3,1,1",
        "user_id": 83,
        "sex": 1,
        "measure_title": "儿童抑郁障碍自评量表(DSRSC)",
        "mid": 115,
        "show_result": 0,
        "department_name": "精神（心理）门诊",
        "user_name": "侯茂捷",
        "user_account": "1304",
        "age": 11,
        "create_time": "2023-04-06 10:10:07",
        "warning": 0,
        "inspect": 0
    }
]
';

$user_id = json_decode($data,true);
$user_answer = array_column($user_id,'answers','user_id');
foreach ($user_answer as &$v){
    $v = explode(',',$v);
}unset($v);
//var_dump($user_answer);

// 这个是量表答案的提交
$send = '{
    "measureId": "218",
    "systemAccess": {
        "accessToken": "md5"
    },
    "isSave": true,
    "answer": [
        {
            "id": 6237,
            "answer": "B"
        },
        {
            "id": 6238,
            "answer": "B"
        },
        {
            "id": 6239,
            "answer": "B"
        },
        {
            "id": 6240,
            "answer": "B"
        },
        {
            "id": 6241,
            "answer": "B"
        },
        {
            "id": 6242,
            "answer": "B"
        },
        {
            "id": 6243,
            "answer": "B"
        },
        {
            "id": 6244,
            "answer": "B"
        },
        {
            "id": 6245,
            "answer": "B"
        },
        {
            "id": 6246,
            "answer": "B"
        },
        {
            "id": 6247,
            "answer": "B"
        },
        {
            "id": 6248,
            "answer": "B"
        },
        {
            "id": 6249,
            "answer": "B"
        },
        {
            "id": 6250,
            "answer": "B"
        },
        {
            "id": 6251,
            "answer": "B"
        },
        {
            "id": 6252,
            "answer": "B"
        },
        {
            "id": 6253,
            "answer": "B"
        },
        {
            "id": 6254,
            "answer": "B"
        }
    ],
    "inputs": {},
    "user_id": "261"
}';

$send = json_decode($send,true);
//var_dump($send);
$test = [];
foreach ($user_answer as $k =>  $v){
    $send['user_id'] = $k;
    foreach ($v as $kk => $vv){
        $send['answer'][$kk]['answer'] = chr(64 + $vv);
    }
    $test[] = $send;
}
file_put_contents('1.txt',json_encode($test,JSON_PRETTY_PRINT),);
var_dump($test);